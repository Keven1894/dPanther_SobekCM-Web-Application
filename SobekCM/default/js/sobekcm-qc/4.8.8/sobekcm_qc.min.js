function qc_set_fullscreen(){var i=$("#allThumbnailsOuterDiv1").offset().top,r=$(window).height(),t=Math.floor(r-i-63),n;$("#allThumbnailsOuterDiv1").height(t);n=Math.floor($(window).width())-12;$("#allThumbnailsOuterDiv1").width(n);document.getElementById("QC_window_height").value=t.toString();document.getElementById("QC_window_width").value=n.toString();n>1022?(document.getElementById("GoToThumbnailTextSpan").innerHTML="GO TO THUMBNAIL:",document.getElementById("sbkQc_GoToThumbnailDiv").style.visibility="visible"):n<1022&&n>999?(document.getElementById("GoToThumbnailTextSpan").innerHTML="GO TO:",document.getElementById("sbkQc_GoToThumbnailDiv").style.visibility="visible"):n<999&&(document.getElementById("GoToThumbnailTextSpan").innerHTML="GO TO THUMBNAIL:",document.getElementById("sbkQc_GoToThumbnailDiv").style.visibility="hidden")}function Set_Default_Images(n,t){no_page_image_url=n;no_thumb_url=t}function QC_Add_Image_To_Dictionary(n,t,i){i.length>0&&i.length>0&&(thumbnailImageDictionary[n]=i)}function QC_Change_Sortable_Setting(n,t,i){var r;makeSortable=n;r=document.getElementById("QC_sortable_option");r.value=makeSortable;var u=document.getElementById("checkmarkEnableSorting"),f=document.getElementById("checkmarkDisableSorting"),e=document.getElementById("checkmarkEnableSorting_conf");u.src=i;f.src=i;e.src=i;n==1?(u.src=t,$("#allThumbnailsOuterDiv").sortable("enable")):n==2?(e.src=t,$("#allThumbnailsOuterDiv").sortable("enable")):(f.src=t,$("#allThumbnailsOuterDiv").sortable("disable"),$("#allThumbnailsOuterDiv input").bind("click.sortable mousedown.sortable",function(n){n.target.focus()}),$("#allThumbnailsOuterDiv select").bind("click.sortable mousedown.sortable",function(n){n.target.focus()}),$("#allThumbnailsOuterDiv").delegate("input[type=text],textarea","focus",function(){$("#allThumbnailsOuterDiv").enableSelection()}));$("ul.qc-menu").hideSuperfishUl()}function Autonumbering_mode_changed(n,t,i){var r,u,f;for(autonumberingMode=n,document.getElementById("QC_autonumber_option").value=n,r=0;r<=2;r++)u=document.getElementById("checkmarkMode"+r),u.src=i;f=document.getElementById("checkmarkMode"+n);f.src=t;$("ul.qc-menu").hideSuperfishUl()}function Configure_QC(){var t,n;for(spanArrayObjects=$("#allThumbnailsOuterDiv").children(),spanArray=[],t=0,n=0;n<spanArrayObjects.length;n++)spanArrayObjects[n].id.indexOf("span")==0&&(spanArray[t++]=spanArrayObjects[n].id);autonumberingMode=document.getElementById("QC_autonumber_option").value;makeSortable=document.getElementById("QC_sortable_option").value}function UpdateDivDropdown(n){var i=n.replace("newDivType",""),h=document.getElementById(n),r=document.getElementById("selectDivType"+i),f=document.getElementById("txtDivName"+i),o,s;if(h.checked==!0)r.disabled=!1,f.disabled=!1;else{r.disabled=!0;f.disabled=r.value.indexOf("!")==0?!1:!0;var t=spanArray.indexOf("span"+i),e="Main",u="";for(t>0&&(o=spanArray[t-1].replace("span","selectDivType"),e=document.getElementById(o).value,s=spanArray[t-1].replace("span","txtDivName"),u=document.getElementById(s).value);t<spanArray.length&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!0;)document.getElementById(spanArray[t].replace("span","selectDivType")).value=e,document.getElementById(spanArray[t].replace("span","txtDivName")).value=u,document.getElementById(spanArray[t].replace("span","divNameTableRow")).style.visibility=u.length>0?"visible":"hidden",t++}return!0}function DivisionTypeChanged(n){var i=n.replace("selectDivType",""),u=document.getElementById(n),t=spanArray.indexOf("span"+i)+1,r=u.value;if(u.value.indexOf("!")==0)for(document.getElementById("divNameTableRow"+i).style.visibility="visible",document.getElementById("divNameTableRow"+i).value="";t<spanArray.length&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!0;)document.getElementById(spanArray[t].replace("span","selectDivType")).value=r,document.getElementById(spanArray[t].replace("span","txtDivName")).disabled=!0,document.getElementById(spanArray[t].replace("span","divNameTableRow")).style.visibility="visible",t++;else if(r.indexOf("!")==-1)for(document.getElementById("divNameTableRow"+i).value="",document.getElementById("divNameTableRow"+i).style.visibility="hidden";t<spanArray.length&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!0;)document.getElementById(spanArray[t].replace("span","selectDivType")).value=r,document.getElementById(spanArray[t].replace("span","txtDivName")).value="",document.getElementById(spanArray[t].replace("span","divNameTableRow")).style.visibility="hidden",t++}function DivNameTextChanged(n){for(var i=n.replace("txtDivName",""),r=document.getElementById(n),t=spanArray.indexOf("span"+i)+1,u=r.value;t<spanArray.length&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!0;)document.getElementById(spanArray[t].replace("span","txtDivName")).value=u,t++}function PaginationTextChanged(n){var v=autonumberingMode,u,g,nt,tt,et,c,ht,b,l,y,e,k,ut,d,o,lt,h,at,ft,t,i;if(v!=2){u=document.getElementById(n).value;u.length==0&&(g=document.getElementById(n.replace("textbox","selectDivType")).value,nt=g,g[0]=="!"&&(tt=document.getElementById(n.replace("textbox","txtDivName")).value,tt.length>0&&(nt=tt)),document.getElementById(n).value=nt+" 1",u=document.getElementById(n).value,v=1);et=!isNaN(parseFloat(u))&&isFinite(u);et&&(document.getElementById(n).value="Page "+u,u=document.getElementById(n).value);var vt=n.replace("textbox",""),f=u.split(" ")[u.split(" ").length-1],it=document.getElementById("Autonumber_text_without_number"),w=document.getElementById("Autonumber_number_only"),rt=f.match(/\d+/g),ot=!0,st=!0;for(i=0;i<f.length;i++)y=f.charAt(i),"IVXLCDM".indexOf(y)==-1&&"ivxlcdm".indexOf(y)==-1&&(ot=!1);if(b=document.getElementById(spanArray[spanArray.length-1].replace("span","filename")),document.getElementById("Autonumber_last_filename").value=b.value,rt!=null){if(rt[0].length==f.length){for(document.getElementById("autonumber_mode_from_form").value=v,document.getElementById("Autonumber_number_system").value="decimal",w.value=f,it.value=u.substr(0,u.length-rt[0].length),c=parseInt(f),t=spanArray.indexOf("span"+vt)+1;t<spanArray.length;t++){if(v=="1"&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!1)break;c++;w.value=c.toString();ht=document.getElementById(spanArray[t].replace("span","textbox"));ht.value=it.value+c}b=document.getElementById(spanArray[spanArray.length-1].replace("span","filename"));document.getElementById("Autonumber_last_filename").value=b.value}}else if(ot==!0){for(l="No error",i=0;i<f.length;i++)y=f.charAt(i),st="IVXLCDM".indexOf(y)>-1?!1:!0;for(e=f.toUpperCase().trim(),(e.split("V").length>2||e.split("L").length>2||e.split("D").length>2)&&(l="Repeated use of V,L or D"),k=1,ut="Z",i=0;i<e.length;i++)e.charAt(i)==ut?(k++,k==4&&(l="Single letter repeated more than thrice")):(k=1,ut=e.charAt(i));for(var a=0,s=[],ct=1e3,r=0,o=0;a<e.length;){d=e.charAt(a);switch(d){case"I":r=1;break;case"V":r=5;break;case"X":r=10;break;case"L":r=50;break;case"C":r=100;break;case"D":r=500;break;case"M":r=1e3}if(r>ct&&(l="Smaller value incorrectly placed to the left of a larger value numeral"),o=0,a<e.length-1){lt=e.charAt(a+1);switch(lt){case"I":o=1;break;case"V":o=5;break;case"X":o=10;break;case"L":o=50;break;case"C":o=100;break;case"D":o=500;break;case"M":o=1e3}o>r&&(("IXC".indexOf(d)==-1||o>r*10||e.split(d).length>3)&&(l="Rule of subtractive combination violated"),ct=r-1,r=o-r,a++)}s.push(r);a++}for(t=0;t<s.length-1;t++)s[t]<s[t+1]&&(l="Larger valued numeral(pair) found to the right of a smaller value");for(h=0,t=0;t<s.length;t++)h=h+s[t];if(typeof h=="number"&&l=="No error")for(f==document.getElementById(n).value&&(document.getElementById(n).value="Page "+u,u=document.getElementById(n).value),at=document.getElementById("autonumber_mode_from_form"),at.value="0",ft=document.getElementById("Autonumber_number_system"),ft.value="ROMAN",w.value=h,t=spanArray.indexOf("span"+n.split("textbox")[1])+1;t<=spanArray.length;t++){if(h++,v=="1"&&document.getElementById(spanArray[t].replace("span","selectDivType")).disabled==!1)break;if(document.getElementById(spanArray[t].replace("span","textbox"))){var c=h,s=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],yt=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],p="";for(i=0;i<13;i++)while(c>=s[i])c=c-s[i],p=p+yt[i];st&&(p=p.toLowerCase(),ft.value="roman");document.getElementById(spanArray[t].replace("span","textbox")).value=document.getElementById(n).value.substr(0,document.getElementById(n).value.length-f.length-1)+" "+p;it.value=document.getElementById(n).value.substr(0,document.getElementById(n).value.length-f.length-1)+" ";w.value=h}}}}}function showQcPageIcons(n){var t=n.replace("span","qcPageOptions");document.getElementById(t).style.visibility="visible"}function hideQcPageIcons(n){var t=n.replace("span","qcPageOptions");document.getElementById(t).style.visibility="hidden"}function showErrorIcon(n){var i=n.replace("span","error"),t=document.getElementById(i);t!=null&&(t.className="errorIconSpanHover")}function hideErrorIcon(n){var i=n.replace("span","error"),t=document.getElementById(i);t!=null&&(t.className="errorIconSpan")}function apply_Main_Thumbnail_Cursor_Control(){var n,t;if(cursorMode==2)ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent");else{for(ResetCursorToDefault(),$("#qc_mainmenu_thumb").addClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=$("#"+spanArray[n]),t.removeClass("qcResetMouseCursorToDefault"),t.addClass("qcPickMainThumbnailCursor");cursorMode=2;$("#allThumbnailsOuterDiv").sortable("disable")}return event.stopImmediatePropagation(),!1}function mainthumbnailicon_click(){var n,t;if(cursorMode==2)ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent");else{for(ResetCursorToDefault(),$("#qc_mainmenu_thumb").addClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=$("#"+spanArray[n]),t.removeClass("qcResetMouseCursorToDefault"),t.addClass("qcPickMainThumbnailCursor");cursorMode=2;$("#allThumbnailsOuterDiv").sortable("disable")}return!1}function defaulticon_click(){return ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent"),!1}function ResetCursorToDefault(){var n,t,i,r;for(cursorMode=1,$("#qc_mainmenu_default").removeClass("sbkQc_MainMenuIconCurrent"),$("#qc_mainmenu_thumb").removeClass("sbkQc_MainMenuIconCurrent"),$("#qc_mainmenu_move").removeClass("sbkQc_MainMenuIconCurrent"),$("#qc_mainmenu_delete").removeClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=$("#"+spanArray[n]),t.removeClass("qcPickMainThumbnailCursor"),t.removeClass("qcMovePagesCursor"),t.removeClass("qcDeletePagesCursor"),t.addClass("qcResetMouseCursorToDefault"),i=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),i.checked==!0&&(i.checked=!1,t.removeClass("sbkQc_SpanSelected")),i.style.visibility="hidden",r=document.getElementById(spanArray[n].replace("span","movePageArrows")),r.style.visibility="hidden";document.getElementById("divMoveOnScroll").style.visibility="hidden";document.getElementById("divDeleteMoveOnScroll").style.visibility="hidden";(makeSortable==1||makeSortable==2)&&$("#allThumbnailsOuterDiv").sortable("enable")}function movepagesicon_click(){var t,r,n,i;if(cursorMode==3){for(t=0,n=0;n<spanArray.length;n++)r=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),r.checked&&t++;t==0?cancel_move_pages():(update_preview(),popup("form_qcmove"))}else{for(ResetCursorToDefault(),n=0;n<spanArray.length;n++)i=$("#"+spanArray[n]),i.removeClass("qcResetMouseCursorToDefault"),i.addClass("qcMovePagesCursor");cursorMode=3;$("#qc_mainmenu_move").addClass("sbkQc_MainMenuIconCurrent");$("#allThumbnailsOuterDiv").sortable("disable")}return!1}function bulkdeleteicon_click(){var n,t;if(cursorMode==4)DeleteSelectedPages();else{for(ResetCursorToDefault(),n=0;n<spanArray.length;n++)t=$("#"+spanArray[n]),t.removeClass("qcResetMouseCursorToDefault"),t.addClass("qcDeletePagesCursor");cursorMode=4;$("#qc_mainmenu_delete").addClass("sbkQc_MainMenuIconCurrent");$("#allThumbnailsOuterDiv").sortable("disable")}return!1}function MakeSortable1(){var t,n;$("#allThumbnailsOuterDiv").sortable({containment:"parent",start:function(n,i){t=spanArray.indexOf($(i.item).attr("id"))},stop:function(i,r){var l=[],v,s,y,h,c,e,o;for(spanArrayObjects=$("#allThumbnailsOuterDiv").children(),v=0,s=0;s<spanArrayObjects.length;s++)spanArrayObjects[s].id.indexOf("span")==0&&(l[v++]=spanArrayObjects[s].id);if(y=$(r.item).attr("id"),n=l.indexOf($(r.item).attr("id")),h=!0,makeSortable==2&&t!=n&&(h=confirm("Are you sure you want to move this page?")),h==!1)$(this).sortable("cancel");else if(h==!0&&t!=n){var u=y.replace("span",""),p=document.getElementById("newDivType"+u),f=spanArray[t+1],a=document.getElementById(f.replace("span","newDivType"));p.checked==!0&&a!=null&&a.checked==!1&&(a.checked=!0,c=document.getElementById(f.replace("span","selectDivType")),c.disabled=!1,c.value=document.getElementById("selectDivType"+u).value,c.value.index("!")==0?(document.getElementById(f.replace("span","divNameTableRow")).style.visibility="visible",document.getElementById(f.replace("span","txtDivName")).disabled=!1,document.getElementById(f.replace("span","txtDivName")).value=""):(document.getElementById(f.replace("span","divNameTableRow")).style.visibility="hidden",document.getElementById(f.replace("span","txtDivName")).disabled=!0,document.getElementById(f.replace("span","txtDivName")).value=""));spanArray=l;e=document.getElementById("selectDivType"+u);n==0?(o=spanArray[1].replace("span",""),document.getElementById("newDivType"+u).checked=!0,e.disabled=!1,e.value=document.getElementById("selectDivType"+o).value,document.getElementById("newDivType"+o).checked=!1,document.getElementById("selectDivType"+o).disabled=!0,document.getElementById("txtDivName"+o).disabled=!0,e.value.indexOf("!")==0?(document.getElementById("divNameTableRow"+u).style.visibility="visible",document.getElementById("txtDivName"+u).value=document.getElementById("txtDivName"+o).value,document.getElementById("txtDivName"+u).disabled=!1):(document.getElementById("divNameTableRow"+u).style.visibility="hidden",document.getElementById("txtDivName"+u).value="",document.getElementById("txtDivName"+u).disabled=!0)):n>0&&(e.value=document.getElementById(spanArray[n-1].replace("span","selectDivType")).value,document.getElementById("newDivType"+u).checked=!1,e.disabled=!0,document.getElementById("txtDivName"+u).disabled=!0,e.value.indexOf("!")==0?(document.getElementById("divNameTableRow"+u).style.visibility="visible",document.getElementById("txtDivName"+u).value=document.getElementById(spanArray[n-1].replace("span","txtDivName")).value):(document.getElementById("divNameTableRow"+u).style.visibility="hidden",document.getElementById("txtDivName"+u).value=""))}},placeholder:"ui-state-highlight"});$("#allThumbnailsOuterDiv").disableSelection();makeSortable==3&&$("#allThumbnailsOuterDiv").sortable("disable");$("#allThumbnailsOuterDiv input").bind("click.sortable mousedown.sortable",function(n){n.target.focus()});$("#allThumbnailsOuterDiv select").bind("click.sortable mousedown.sortable",function(n){n.target.focus()});$("#allThumbnailsOuterDiv").delegate("input[type=text],textarea","focus",function(){$("#allThumbnailsOuterDiv").enableSelection()})}function behaviors_cancel_form(){return document.getElementById("QC_behaviors_request").value="cancel",document.itemNavForm.submit(),!1}function behaviors_save_form(){return document.getElementById("QC_behaviors_request").value="save",document.itemNavForm.submit(),!1}function changeAutoSaveOption(){var n=document.getElementById("autosaveLink"),t=document.getElementById("Autosave_Option"),i=document.getElementById("QC_behaviors_request");return i.value="save",n.innerHTML=="Turn Off Autosave"?(n.innerHTML="Turn On Autosave",t.value="false"):(n.innerHTML="Turn Off Autosave",t.value="true"),document.itemNavForm.submit(),!1}function qc_auto_save(){jQuery("form").each(function(){var t=document.getElementById("QC_behaviors_request"),n;t.value="autosave";n=window.location.href.toString();$.ajax({url:n,data:"autosave=true&"+jQuery(this).serialize(),type:"POST",async:!0,success:function(){var i=new Date,n=i.getHours(),t=i.getMinutes(),u=n>=12?"PM":"AM",r,f;return n=n%12,n=n?n:12,n=n<10?"0"+n:n,t=t<10?"0"+t:t,r=n+":"+t+" "+u,f="Saved at "+r,!1}})})}function qccheckbox_onchange(n,t){var u,f,i,e,r;if(cursorMode==3||cursorMode==4){if(document.getElementById(t).checked==!0?$("#"+t.replace("chkMoveThumbnail","span")).addClass("sbkQc_SpanSelected"):$("#"+t.replace("chkMoveThumbnail","span")).removeClass("sbkQc_SpanSelected"),u=!1,document.getElementById(t).checked==!0)u=!0;else for(f=0;f<spanArray.length;f++)if(document.getElementById("chkMoveThumbnail"+f).checked==!0){u=!0;break}if(u){if(cursorMode==3)for(document.getElementById("divMoveOnScroll").style.visibility="visible",i=0;i<spanArray.length;i++)e=document.getElementById(spanArray[i].replace("span","movePageArrows")),e.style.visibility="visible";cursorMode==4&&(document.getElementById("divDeleteMoveOnScroll").style.visibility="visible")}else for(document.getElementById("divMoveOnScroll").style.visibility="hidden",document.getElementById("divDeleteMoveOnScroll").style.visibility="hidden",i=0;i<spanArray.length;i++)e=document.getElementById(spanArray[i].replace("span","movePageArrows")),e.style.visibility="hidden";r=n?n:window.event;r!=null&&(r.stopPropagation&&r.stopPropagation(),r.cancelBubble!=null&&(r.cancelBubble=!0))}}function rbMovePagesChanged(n){n=="After"?(document.getElementById("selectDestinationPageList1").disabled=!1,document.getElementById("selectDestinationPageList2").disabled=!0):n=="Before"&&(document.getElementById("selectDestinationPageList2").disabled=!1,document.getElementById("selectDestinationPageList1").disabled=!0);update_preview()}function update_popup_form(n,t,i){var h,o,u,s,r;page_index_popup=n;h=document.getElementById("chkMoveThumbnail"+n);h.checked=!h.checked;var c=document.getElementById("QC_behaviors_request"),f=document.getElementById("QC_move_relative_position"),e=document.getElementById("QC_move_destination");if(c.value="move_selected_pages",f.value="",e.value="",i=="After"){if(document.getElementById("selectDestinationPageList1")){for(document.getElementById("rbMovePages1").checked=!0,document.getElementById("selectDestinationPageList1").disabled=!1,document.getElementById("selectDestinationPageList2").disabled=!0,r=document.getElementById("selectDestinationPageList1"),o=r.options.length,u=0;u<o;u++)r.options[u].text==t&&(r.selectedIndex=u);f.value="After";r=document.getElementById("selectDestinationPageList1");s=r.selectedIndex;e.value=r.options[s].value}}else if(i=="Before"&&document.getElementById("selectDestinationPageList1")){for(document.getElementById("rbMovePages2").checked=!0,document.getElementById("selectDestinationPageList1").disabled=!0,document.getElementById("selectDestinationPageList2").disabled=!1,r=document.getElementById("selectDestinationPageList2"),o=r.options.length,u=0;u<o;u++)r.options[u].text==t&&(r.selectedIndex=u);document.getElementById("selectDestinationPageList2").selectedIndex>0?(r=document.getElementById("selectDestinationPageList2"),s=r.selectedIndex-1,f.value="After",e.value=r.options[s].value):(f.value="Before",r=document.getElementById("selectDestinationPageList2"),e.value=r.options[r.selectedIndex].value)}update_preview()}function cancel_move_pages(){var n,t;for($("#form_qcmove").css("display")!="none"&&popdown("form_qcmove"),ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),t.checked==!0&&(t.checked=!1),document.getElementById("movePageArrows"+n).style.visibility="hidden";return!1}function move_pages_submit(){var u=document.getElementById("QC_behaviors_request"),t=document.getElementById("QC_move_relative_position"),i=document.getElementById("QC_move_destination"),n,r;return u.value="move_selected_pages",t.value="",i.value="",document.getElementById("rbMovePages2").checked==!0?document.getElementById("selectDestinationPageList2").selectedIndex>0?(n=document.getElementById("selectDestinationPageList2"),r=n.selectedIndex-1,t.value="After",i.value=n.options[r].value):(t.value="Before",n=document.getElementById("selectDestinationPageList2"),i.value=n.options[n.selectedIndex].value):(t.value="After",n=document.getElementById("selectDestinationPageList1"),r=n.selectedIndex,i.value=n.options[r].value),document.itemNavForm.submit(),!1}function update_preview(){var c=document.getElementById("rbMovePages2"),l=document.getElementById("rbMovePages1"),t=document.getElementById("selectDestinationPageList2"),n=document.getElementById("selectDestinationPageList1"),e=document.getElementById("prevThumbnailImage"),f=document.getElementById("nextThumbnailImage"),a=document.getElementById("PlaceholderThumbnailImage1"),v=document.getElementById("PlaceholderThumbnailImage2"),y=document.getElementById("PlaceholderThumbnailImage3"),r,h;c.checked==!0?(t.selectedIndex==0?(e.src=no_page_image_url,document.getElementById("prevFileName").innerHTML=""):t.options[t.selectedIndex-1].value.length>0&&(e.src=thumbnailImageDictionary[t.options[t.selectedIndex-1].value]?thumbnailImageDictionary[t.options[t.selectedIndex-1].value]:no_thumb_url,document.getElementById("prevFileName").innerHTML=filename_truncate(t.options[t.selectedIndex-1].value)),t.options[t.selectedIndex].value.length>0?(f.src=thumbnailImageDictionary[t.options[t.selectedIndex].value]?thumbnailImageDictionary[t.options[t.selectedIndex].value]:no_thumb_url,document.getElementById("nextFileName").innerHTML=filename_truncate(t.options[t.selectedIndex].value)):(f.src=no_thumb_url,document.getElementById("nextFileName").innerHTML="")):l.checked==!0&&(n.selectedIndex==n.options.length-1?(f.src=no_page_image_url,document.getElementById("nextFileName").innerHTML=""):n.options[n.selectedIndex+1].value.length>0&&thumbnailImageDictionary[n.options[n.selectedIndex+1].value]&&thumbnailImageDictionary[n.options[n.selectedIndex+1].value].length>0?(f.src=thumbnailImageDictionary[n.options[n.selectedIndex+1].value]?thumbnailImageDictionary[n.options[n.selectedIndex+1].value]:no_thumb_url,document.getElementById("nextFileName").innerHTML=filename_truncate(n.options[n.selectedIndex+1].value)):(f.src=no_page_image_url,document.getElementById("nextFileName").innerHTML=""),n.options[n.selectedIndex].value.length>0&&thumbnailImageDictionary[n.options[n.selectedIndex].value].length>0?(e.src=thumbnailImageDictionary[n.options[n.selectedIndex].value]?thumbnailImageDictionary[n.options[n.selectedIndex].value]:no_page_image_url,document.getElementById("prevFileName").innerHTML=filename_truncate(n.options[n.selectedIndex].value)):(e.src=no_page_image_url,document.getElementById("prevFileName").innerHTML=""));var u=0,o=document.getElementById("PlaceholderThumbnail1"),s=document.getElementById("PlaceholderThumbnail2"),p=document.getElementById("PlaceholderThumbnail3"),i;for(r=0;r<spanArray.length;r++){if(h=document.getElementById(spanArray[r].replace("span","chkMoveThumbnail")),page_index_popup.length>0&&document.getElementById("chkMoveThumbnail"+page_index_popup).checked==!0&&page_index_popup==spanArray[r].replace("span","")){page_index_popup="";continue}else page_index_popup.length>0&&document.getElementById("chkMoveThumbnail"+page_index_popup).checked==!1&&page_index_popup==spanArray[r].replace("span","")&&(u++,u==1&&(i=document.getElementById("filename"+page_index_popup).value));h.checked==!0&&(u++,u==1&&(i=document.getElementById(spanArray[r].replace("span","filename")).value))}u==1?(o.style.visibility="hidden",s.style.visibility="hidden"):u>1&&(o.style.visibility="visible",s.style.visibility="visible");a.src=thumbnailImageDictionary[i]?thumbnailImageDictionary[i]:no_page_image_url;v.src=thumbnailImageDictionary[i]?thumbnailImageDictionary[i]:no_page_image_url;y.src=thumbnailImageDictionary[i]?thumbnailImageDictionary[i]:no_page_image_url;document.getElementById("placeHolderText1").innerHTML=filename_truncate(i);document.getElementById("placeHolderText2").innerHTML=filename_truncate(i);document.getElementById("placeHolderText3").innerHTML=filename_truncate(i)}function ImageDeleteClicked(n){var t=confirm("Are you sure you want to delete this page and all files associated with it? All changes up to this point will be applied.");return t==!0&&(document.getElementById("QC_behaviors_request").value="delete_page",document.getElementById("QC_affected_file").value=n,document.itemNavForm.submit()),!1}function DeleteSelectedPages(){for(var r,t,i=0,n=0;n<spanArray.length;n++)t=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),t.checked&&i++;if(i==0)for(ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),t.checked==!0&&(t.checked=!1);else if(r=confirm("Are you sure you want to delete these "+i+" pages and all files associated with them? All changes up to this point will be applied."),r==!0)document.getElementById("QC_behaviors_request").value="delete_selected_pages",document.itemNavForm.submit();else for(ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent"),n=0;n<spanArray.length;n++)t=document.getElementById(spanArray[n].replace("span","chkMoveThumbnail")),t.checked==!0&&(t.checked=!1,$("#"+spanArray[n]).removeClass("sbkQc_SpanSelected"));return!1}function thumbnail_click(n,t){cursorMode==1&&window.open(t,n)}function save_submit_form(){return document.getElementById("QC_behaviors_request").value="complete",document.itemNavForm.submit(),!1}function ClearPagination(){return document.getElementById("QC_behaviors_request").value="clear_pagination",document.itemNavForm.submit(),!1}function ClearReorderPagination(){return document.getElementById("QC_behaviors_request").value="clear_reorder",document.itemNavForm.submit(),!1}function UploadNewPageImages(n){var t=confirm("Are you sure you want to add more page images?   Any unsaved changes will be lost.");return t==!0&&(window.location.href=n),!1}function qcspan_mouseover(n){return $("#"+n).removeClass("sbkQc_SpanMouseOut"),$("#"+n).addClass("sbkQc_SpanMouseOver"),showQcPageIcons(n),showErrorIcon(n),!1}function qcspan_mouseout(n){return $("#"+n).removeClass("sbkQc_SpanMouseOver"),$("#"+n).addClass("sbkQc_SpanMouseOut"),hideQcPageIcons(n),hideErrorIcon(n),!1}function qcspan_onclick(n,t){var u=t.replace("span",""),r,i;if(cursorMode==2){for(document.getElementById("Main_Thumbnail_File").value=document.getElementById("filename"+u).value,ResetCursorToDefault(),$("#qc_mainmenu_default").addClass("sbkQc_MainMenuIconCurrent"),i=0;i<spanArray.length;i++)if(document.getElementById(spanArray[i].replace("span","pick_main_thumbnail")).className=="QC_MainThumbnail_Visible"){document.getElementById(spanArray[i].replace("span","pick_main_thumbnail")).className="QC_MainThumbnail_Hidden";break}document.getElementById("pick_main_thumbnail"+u).className="QC_MainThumbnail_Visible"}if(cursorMode==3||cursorMode==4){if(r=document.getElementById("chkMoveThumbnail"+u),r.checked=!r.checked,n.shiftKey){if(r.checked&&lastSelected>=0){var f=spanArray.indexOf(t),e=Math.min(f,lastSelected),o=Math.max(f,lastSelected);for(i=e;i<o;i++)document.getElementById(spanArray[i].replace("span","chkMoveThumbnail")).checked=!0,$("#"+spanArray[i]).addClass("sbkQc_SpanSelected")}}else lastSelected=r.checked?spanArray.indexOf(t):-1;qccheckbox_onchange(null,"chkMoveThumbnail"+u)}}function filename_truncate(n){var f="",r=13,t=n,i,u;if(n.length>16)if(isNaN(n[n.length-1]))f=t,t=t.substring(0,r)+"...";else{for(i=1;!isNaN(t[n.length-(1+i)]);)i++;u=r-i;u<2?t="..."+t.substring(t.length-Math.min(i,r)):(f=t,t=t.substring(0,u)+"..."+t.substring(t.length-i))}return t}function Set_Error_Page(n,t){var i=document.getElementById("QC_affected_file");i.value=n;$('input[name="rbFile_errors"]').val([t])}function save_qcErrors(){document.getElementById("QC_behaviors_request").value="save_error";document.getElementById("QC_error_number").value=$("input[name='rbFile_errors']:checked").val();document.itemNavForm.submit()}function ddlCriticalVolumeError_change(n){document.getElementById("QC_behaviors_request").value="save_error";document.getElementById("QC_error_number").value=n;document.getElementById("QC_affected_file").value="-1";document.itemNavForm.submit()}var spanArrayObjects,spanArray,autonumberingMode=-1,makeSortable=3,cursorMode=1,lastSelected=-1,thumbnailImageDictionary={},no_page_image_url,no_thumb_url,page_index_popup=""